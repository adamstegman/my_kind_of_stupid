<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta http-equiv="Content-Language" content="en-us"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="keywords" content=""/>
  <meta name="description" content=""/>
  <title>Rendering array properties in Ember.js - My Kind of Stupid</title>
  <link type="application/atom+xml" href="/feed.xml" rel="alternate" title="Articles"/>
  <link type="image/vnd.microsoft.icon" href="/favicon.ico" rel="icon"/>
  <link type="text/css" href="/stylesheets/application.css" rel="stylesheet"/>
  
</head>
<body>
  <header>
    <div class="container">
      <hgroup>
        <h1><a href="/" class="title">My Kind of Stupid</a></h1>
        <h2>Web development, user interfaces, and other development topics.</h2>
      </hgroup>
      <nav>
        <ul class="nav-list">
          <li><a href="/">Articles</a></li>
          <li><a href="http://adamstegman.com/">Adam Stegman</a></li>
          <li><a rel="me" href="http://twitter.com/adamstegman">Twitter</a></li>
          <li><a rel="me" href="http://github.com/adamstegman">Github</a></li>
      </nav>
    </div>
  </header>
  <div class="content">
    <div class="container">
      <article itemscope="true" itemtype="http://www.schema.org/BlogPosting">
        <header>
          <hgroup>
            
            <h2 itemprop="name">Rendering array properties in Ember.js</h2>
            
            
          </hgroup>
        </header>
        <div class="article-body" itemprop="articleBody">
          <p>While working on photo uploads in my <a href='https://github.com/adamstegman/photo_albums'>latest project</a>, I needed a network activity indicator to reflect background network usage. That way, users could navigate away from the upload form and see that uploads were still going in the background. Since I&#8217;m using <a href='http://emberjs.com/'>Ember.js</a> I created a component to display the indicator. I created an array in my <code>ApplicationController</code> to track each upload. For each element in the array, I rendered a network activity indicator.</p>

<p>The concept was pretty straightforward and in a simple case worked fine. But when I removed an indicator after an upload was done, I got a strange error:</p>

<pre><code>TypeError: Cannot read property &#39;destroy&#39; of undefined
    at Ember.CollectionView.Ember.ContainerView.extend.arrayWillChange (http://localhost:8888/assets/ember.js?body=true:23233:16)
    at null._contentWillChange (http://localhost:8888/assets/ember.js?body=true:23140:10)
    at sendEvent (http://localhost:8888/assets/ember.js?body=true:2302:14)
    at notifyBeforeObservers (http://localhost:8888/assets/ember.js?body=true:2671:5)
    at Object.propertyWillChange (http://localhost:8888/assets/ember.js?body=true:2497:3)
    at set (http://localhost:8888/assets/ember.js?body=true:2763:15)
    at Object.Ember.trySet (http://localhost:8888/assets/ember.js?body=true:2832:10)
    at Object.Binding._sync (http://localhost:8888/assets/ember.js?body=true:6765:15)
    at Object.DeferredActionQueues.flush (http://localhost:8888/assets/ember.js?body=true:5565:24)
    at Object.Backburner.end (http://localhost:8888/assets/ember.js?body=true:5656:27)</code></pre>

<p>The stacktrace indicated the problem is when I <code>set</code> the new array of uploads. From the description of <a href='http://emberjs.com/api/classes/Ember.CollectionView.html'><code>Ember.CollectionView</code></a> it looked like the problem is with updating the rendered template from the array:</p>

<blockquote>
<p><code>Ember.CollectionView</code> is an <code>Ember.View</code> descendent responsible for managing a collection (an array or array-like object) by maintaining a child view object and associated DOM representation for each item in the array and ensuring that child views and their associated rendered HTML are updated when items in the array are added, removed, or replaced.</p>
</blockquote>

<p>Stack Overflow had <a href='http://stackoverflow.com/a/16661864'>an answer</a> that explained that the problem was with updating the property bindings:</p>

<blockquote>
<p><code>push</code> doesn&#8217;t tell the binding to update, but <code>pushObject</code> does</p>
</blockquote>

<p>Since I was using a native JavaScript array, I was using native methods to add and remove uploads. I needed to use an <code>Ember.NativeArray</code> instead so that I could use it in my template. This is possible using <code>Ember.A</code> to wrap an array-like object:</p>

<pre><code>this.set(&#39;uploadActivityIndicators&#39;, Ember.A([id]));
this.get(&#39;uploadActivityIndicators&#39;).removeObject(id);</code></pre>

<p>From what I&#8217;ve read, this is typical of Emberâ€”use Ember&#8217;s replacements for native JavaScript concepts to avoid any surprises like this. This is one reason why some people prefer Angular or React. I don&#8217;t think this is enough of a reason to write off a framework, it&#8217;s just a guideline of using Ember. It makes it more complicated to learn but doesn&#8217;t make it automatically bad. Still, I need to learn more about Angular and React so I can better compare the options.</p>
        </div>
        <footer>
          <div class="published">
            Published at
            <time datetime="2014-08-23T23:39Z" pubdate="true" itemprop="datePublished">
              August 23, 2014 4:39pm
            </time>
          </div>
        </footer>
      </article>
    </div>
  </div>
  <footer>
    <div class="container">
      <section class="author">
        <h2>
          Written by
          <a rel="author" href="http://adamstegman.com/">Adam Stegman</a>
        </h2>
        <ul class="contact">
          <li>
            <a href="http://twitter.com/adamstegman">Follow me on Twitter</a>
          </li>
          <li>
            <a href="http://github.com/adamstegman">Follow me on Github</a>
          </li>
          <li>
            <a href="http://profiles.google.com/adam.stegman">Google Profile</a>
          </li>
          <li>
            <a href="mailto:me@adamstegman.com">Email me</a>
          </li>
        </ul>
      </section>
    </div>
  </footer>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24951237-1']);
    _gaq.push(['_setDomainName', '.adamstegman.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body>
</html>
