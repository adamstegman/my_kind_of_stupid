{"data":{"markdownRemark":{"html":"<p>While working on photo uploads in my <a href=\"https://github.com/adamstegman/photo_albums\">latest project</a>, I needed a network activity indicator to reflect background network usage.\nThat way, users could navigate away from the upload form and see that uploads were still going in the background.\nSince I'm using <a href=\"http://emberjs.com/\">Ember.js</a> I created a component to display the indicator.\nI created an array in my <code>ApplicationController</code> to track each upload.\nFor each element in the array, I rendered a network activity indicator.</p>\n<p>The concept was pretty straightforward and in a simple case worked fine.\nBut when I removed an indicator after an upload was done, I got a strange error:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>TypeError: Cannot read property 'destroy' of undefined\n    at Ember.CollectionView.Ember.ContainerView.extend.arrayWillChange (http://localhost:8888/assets/ember.js?body=true:23233:16)\n    at null._contentWillChange (http://localhost:8888/assets/ember.js?body=true:23140:10)\n    at sendEvent (http://localhost:8888/assets/ember.js?body=true:2302:14)\n    at notifyBeforeObservers (http://localhost:8888/assets/ember.js?body=true:2671:5)\n    at Object.propertyWillChange (http://localhost:8888/assets/ember.js?body=true:2497:3)\n    at set (http://localhost:8888/assets/ember.js?body=true:2763:15)\n    at Object.Ember.trySet (http://localhost:8888/assets/ember.js?body=true:2832:10)\n    at Object.Binding._sync (http://localhost:8888/assets/ember.js?body=true:6765:15)\n    at Object.DeferredActionQueues.flush (http://localhost:8888/assets/ember.js?body=true:5565:24)\n    at Object.Backburner.end (http://localhost:8888/assets/ember.js?body=true:5656:27)</code></pre>\n      </div>\n<p>The stacktrace indicated the problem is when I <code>set</code> the new array of uploads.\nFrom the description of <a href=\"http://emberjs.com/api/classes/Ember.CollectionView.html\"><code>Ember.CollectionView</code></a> it looked like the problem is with updating the rendered template from the array:</p>\n<blockquote>\n<p><code>Ember.CollectionView</code> is an <code>Ember.View</code> descendent responsible for managing a collection (an array or array-like object) by maintaining a child view object and associated DOM representation for each item in the array and ensuring that child views and their associated rendered HTML are updated when items in the array are added, removed, or replaced.</p>\n</blockquote>\n<p>Stack Overflow had <a href=\"http://stackoverflow.com/a/16661864\">an answer</a> that explained that the problem was with updating the property bindings:</p>\n<blockquote>\n<p><code>push</code> doesn't tell the binding to update, but <code>pushObject</code> does</p>\n</blockquote>\n<p>Since I was using a native JavaScript array, I was using native methods to add and remove uploads.\nI needed to use an <code>Ember.NativeArray</code> instead so that I could use it in my template.\nThis is possible using <code>Ember.A</code> to wrap an array-like object:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-javascript\"><code><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'uploadActivityIndicators'</span><span class=\"token punctuation\">,</span> Ember<span class=\"token punctuation\">.</span><span class=\"token function\">A</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'uploadActivityIndicators'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeObject</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n      </div>\n<p>From what I've read, this is typical of Emberâ€”use Ember's replacements for native JavaScript concepts to avoid any surprises like this.\nThis is one reason why some people prefer Angular or React.\nI don't think this is enough of a reason to write off a framework, it's just a guideline of using Ember.\nIt makes it more complicated to learn but doesn't make it automatically bad.\nStill, I need to learn more about Angular and React so I can better compare the options.</p>","fields":{"post":{"title":"Rendering array properties in Ember.js","link":null,"timestamp":"2014-08-23T23:39Z","date":"August 23, 2014 11:39pm UTC"}}}},"pageContext":{"slug":"/rendering-array-properties-in-ember-js"}}